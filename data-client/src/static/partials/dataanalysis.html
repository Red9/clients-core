
<div class="jumbotron">
        <div class="media">
            <a class="media-left" href="/user/{{dataset.user.id}}">
                <img ng-src="{{dataset.user.picture}}?sz=85" class="profile-pic" height="85px" width="85px">
            </a>

            <div class="media-body">
                <h1 class="media-heading">{{dataset.title}}
                    <span class="nobreak duration">{{dataset.duration | duration:true}}</span>
                </h1>
                <h4>
                    <small>from</small>
                    <a ng-href="/user/{{dataset.user.id}}">{{dataset.user.displayName}}</a>
                    <small>view</small>
                    <a href="/dataset/{{dataset.id}}" target="_self">Detailed Graphs</a>
                    <small>sport</small>
                    {{dataset.sport}}
                </h4>
            </div>
        </div>
        <tag-helper resource="dataset" tag-key="tags"></tag-helper>
</div>

<div class="well">

    <div class="row">
        <div class="col-sm-6">
            <table class="table horizontal">
                <tr>
                    <th>Recorded</th>
                    <td>{{dataset.startTime | date:'short'}} ({{dataset.duration | duration:true}})</td>
                </tr>
                <tr>
                    <th>Uploaded</th>
                    <td>{{dataset.createdAt | date:'short'}}</td>
                </tr>
                <tr>
                    <th>GPS On Time</th>
                    <td>{{dataset.gpsLock.validTime | duration:true}} on ({{dataset.gpsLock.validPercent}}%)</td>
                </tr>
                <tr>
                    <th>Distance</th>
                    <td>{{dataset.summaryStatistics.distance.path | units:'meters':'miles' | number:2}} miles ({{dataset.summaryStatistics.distance.path | number:0}} meters)</td>
                </tr>
            </table>
        </div>
        <div class="col-sm-6">
            <events-summary events="dataset.events"></events-summary>
        </div>
    </div>
</div>

<div class="well">
    <div class="row graph more-margin">
        <div class="col-sm-12">
            <event-timeline events="dataset.events"></event-timeline>
        </div>
    </div>

    <div class="row more-margin map graph">
        <map resource="dataset"></map>
        <br/>
    </div>
</div>

<div class="well">
    <div ng-repeat="(type,events) in dataset.events | groupBy:'type'" class="row">
        <div class="col-sm-12">
            <h3>{{type}}</h3>
        </div>
        <div class="col-sm-12">
            <div ng-include="'/static/partials/eventsummary/' + type.replace(' ', '_').toLowerCase() + '.group.html'"></div>
        </div>
    </div>
</div>

<div class="well">
    <div class="row">
        <div class="col-sm-12">
            <h3>Statistics</h3>
            <div class="alert alert-info" role="alert"><i class="fa fa-flask"> </i> All values in this section are in SI units</div>
        </div>
        <div class="col-sm-12">
            <tabset>
                <tab heading="Summary Statistics">
                    <summary-statistics statistics="dataset.summaryStatistics"></summary-statistics>
                </tab>

                <tab heading="Detailed Location">
                    <div class="row">
                        <div class="col-sm-4">
                            <h4>GPS Lock</h4>
                            <table class="table table-condensed">
                                <tbody>
                                <tr>
                                    <td>Valid Time</td>
                                    <td>{{dataset.gpsLock.validTime | duration:true}} ({{dataset.gpsLock.percentOn}}%)</td>
                                </tr>
                                <tr>
                                    <td>Invalid Time</td>
                                    <td>{{dataset.gpsLock.invalidTime | duration:true}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="col-sm-4">
                            <h4>Bounding Circle</h4>
                            <table class="table table-condensed">
                                <tbody>
                                <tr>
                                    <td>Latitude</td>
                                    <td>{{dataset.boundingCircle.latitude | number:5}}</td>
                                </tr>
                                <tr>
                                    <td>Longitude</td>
                                    <td>{{dataset.boundingCircle.longitude | number:5}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="col-sm-4">
                            <h4>Bounding Box</h4>
                            <table class="table table-condensed">
                                <tbody>
                                <tr>
                                    <td>North</td>
                                    <td>{{dataset.boundingBox.north | number:5}}</td>
                                </tr>
                                <tr>
                                    <td>South</td>
                                    <td>{{dataset.boundingBox.south | number:5}}</td>
                                </tr>
                                <tr>
                                    <td>East</td>
                                    <td>{{dataset.boundingBox.east | number:5}}</td>
                                </tr>
                                <tr>
                                    <td>West</td>
                                    <td>{{dataset.boundingBox.west | number:5}}</td>
                                </tr>


                                </tbody>
                            </table>
                        </div>
                    </div>
                </tab>
            </tabset>
        </div>
    </div>
</div>

<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>

<hr/>
<div class="well">
    <div ng-if="$root.current.user.scope.indexOf('admin') !== -1">

        <div class="row"><h1 class="col-sm-12">Admin Tools</h1></div>

        <div class="row">
            <h2>Select Dataset Sport Type</h2>
            <form class="form-inline">
                <select ng-model="datasetSport" ng-change="saveSport(datasetSport)" class="form-control" ng-options="item as item for item in sportsList"></select></div>
            </form>

        <div class="row">
            <h2>Automatic Event Detection</h2>

            <p>Start event finding. Note that this takes between 30 and 500 seconds. Do not press twice. To see the created
                events you'll need to refresh the page. <br /><br />
                <button class="btn btn-danger" ng-click="eventFind(dataset)" ng-disabled="eventFindDisabled">Event Find</button>
            </p>

        </div>

        <div class="row">
            <h2>Generate FCPXML</h2>
            <fcpxml-download dataset="dataset"></fcpxml-download>
        </div>
    </div>
</div>
